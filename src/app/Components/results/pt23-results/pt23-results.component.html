<div class="pt23-results-container">
  <div class="section-header">
    <h3>PT-23 Results</h3>
    <p>Resultados específicos para el procedimiento PT-23</p>
  </div>

  <!-- Control buttons -->
  <div class="control-buttons">
    <button class="add-btn" (click)="agregarNivel()">
      <i class="material-icons">add</i>
      Agregar Nivel de Tensión
    </button>
    <button class="close-btn" (click)="cerrarTablas()">
      <i class="material-icons">close</i>
      Cerrar Tablas
    </button>
  </div>

  <!-- Results tables -->
  <div class="tables-container">
    <div
      class="tabla-nivel"
      *ngFor="let tabla of tablas; let tablaIndex = index"
    >
      <div class="tabla-header">
        <h4>Nivel de Tensión {{ tablaIndex + 1 }}</h4>
        <div class="nivel-input-group">
          <label>Nivel de Tensión (kV):</label>
          <input
            type="number"
            [(ngModel)]="tabla.nivel"
            placeholder="Ingrese el nivel"
            class="nivel-input"
          />
        </div>
      </div>

      <div class="table-wrapper">
        <table class="results-table">
          <thead>
            <tr>
              <th rowspan="2" class="measurement-header">Medición</th>
              <th colspan="10" class="dut-header">DUT (kV)</th>
              <th colspan="10" class="patron-header">Patrón (kV)</th>
            </tr>
            <tr>
              <!-- DUT columns -->
              <th *ngFor="let fila of filas; let i = index" class="sub-header">
                {{ i + 1 }}
              </th>
              <!-- Patrón columns -->
              <th *ngFor="let fila of filas; let i = index" class="sub-header">
                {{ i + 1 }}
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="row-label">Mediciones PT-23</td>
              <!-- DUT inputs -->
              <td *ngFor="let fila of filas; let i = index" class="data-cell">
                <input
                  type="number"
                  [(ngModel)]="tabla.dut[i]"
                  placeholder=""
                  class="data-input"
                  step="0.001"
                />
              </td>
              <!-- Patrón inputs -->
              <td *ngFor="let fila of filas; let i = index" class="data-cell">
                <input
                  type="number"
                  [(ngModel)]="tabla.patron[i]"
                  placeholder=""
                  class="data-input"
                  step="0.001"
                />
              </td>
            </tr>
            <tr class="average-row">
              <td class="row-label average-label">Promedio</td>
              <!-- DUT average -->
              <td colspan="10" class="average-cell dut-average">
                {{ getAverage(tabla.dut) }}
              </td>
              <!-- Patrón average -->
              <td colspan="10" class="average-cell patron-average">
                {{ getAverage(tabla.patron) }}
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
