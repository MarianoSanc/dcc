<div class="statements-container">
  <div class="section-header">
    <h3>Statements</h3>
    <p>Declaraciones y referencias normativas del certificado de calibración</p>
  </div>

  <!-- Statements List -->
  <div class="statements-list" *ngIf="statements.length > 0">
    <div
      class="statement-card"
      *ngFor="let statement of statements; let statementIndex = index"
    >
      <!-- Statement Block -->
      <div class="data-block">
        <div class="block-header">
          <h4>Statement {{ statementIndex + 1 }}</h4>
          <div class="statement-actions">
            <button
              class="edit-btn"
              (click)="editStatement(statement.id)"
              *ngIf="!isEditing(statement.id)"
            >
              <i class="material-icons">edit</i>
              Editar
            </button>
            <button
              class="save-btn"
              (click)="saveStatement(statement)"
              *ngIf="isEditing(statement.id)"
            >
              <i class="material-icons">save</i>
              Guardar
            </button>
            <button
              class="cancel-btn"
              (click)="cancelEdit(statement.id)"
              *ngIf="isEditing(statement.id)"
            >
              <i class="material-icons">close</i>
              Cancelar
            </button>
            <!-- Botón de eliminar eliminado -->
          </div>
        </div>

        <div class="block-content">
          <!-- View Mode -->
          <div *ngIf="!isEditing(statement.id)" class="statement-view">
            <table class="data-table">
              <tr>
                <td class="label">Convention:</td>
                <td>{{ statement.convention || "No especificado" }}</td>
              </tr>
              <tr>
                <td class="label">Traceable:</td>
                <td>
                  {{
                    statement.traceable === true
                      ? "Sí"
                      : statement.traceable === false
                      ? "No"
                      : "No especificado"
                  }}
                </td>
              </tr>
              <tr>
                <td class="label">Norm:</td>
                <td>{{ statement.norm || "No especificado" }}</td>
              </tr>
              <tr>
                <td class="label">Reference:</td>
                <td>{{ statement.reference || "No especificado" }}</td>
              </tr>
              <tr>
                <td class="label">Valid:</td>
                <td>
                  {{
                    statement.valid === 1
                      ? "Sí"
                      : statement.valid === null
                      ? "No especificado"
                      : "No"
                  }}
                </td>
              </tr>
              <tr>
                <td class="label">Declaration:</td>
                <td class="content-cell">
                  {{
                    statement.declaration ||
                      statement.content ||
                      "No especificado"
                  }}
                </td>
              </tr>
              <tr>
                <td class="label">Resp. Authority Name:</td>
                <td>{{ statement.respAuthority_name || "No especificado" }}</td>
              </tr>
              <tr>
                <td class="label">Resp. Authority Country Code:</td>
                <td>
                  {{ statement.respAuthority_countryCode || "No especificado" }}
                </td>
              </tr>
              <tr>
                <td class="label">Resp. Authority Post Code:</td>
                <td>
                  {{ statement.respAuthority_postCode || "No especificado" }}
                </td>
              </tr>
            </table>
          </div>

          <!-- Edit Mode -->
          <div *ngIf="isEditing(statement.id)" class="statement-edit">
            <div class="edit-form">
              <div class="form-group">
                <label>Convention:</label>
                <input
                  type="text"
                  [(ngModel)]="statement.convention"
                  placeholder="Convention"
                />
              </div>
              <div class="form-group">
                <label>Traceable:</label>
                <select [(ngModel)]="statement.traceable">
                  <option [ngValue]="undefined">No especificado</option>
                  <option [ngValue]="true">Sí</option>
                  <option [ngValue]="false">No</option>
                </select>
              </div>
              <div class="form-group">
                <label>Norm:</label>
                <input
                  type="text"
                  [(ngModel)]="statement.norm"
                  placeholder="Ingrese la norma o estándar"
                />
              </div>
              <div class="form-group">
                <label>Reference:</label>
                <input
                  type="text"
                  [(ngModel)]="statement.reference"
                  placeholder="Ingrese la referencia"
                />
              </div>
              <div class="form-group">
                <label>Valid:</label>
                <select [(ngModel)]="statement.valid">
                  <option [ngValue]="null">No especificado</option>
                  <option [ngValue]="1">Sí</option>
                  <option [ngValue]="0">No</option>
                </select>
              </div>
              <div class="form-group">
                <label>Declaration:</label>
                <textarea
                  [(ngModel)]="statement.declaration"
                  placeholder="Ingrese el contenido de la declaración"
                  rows="4"
                ></textarea>
              </div>
              <div class="form-group">
                <label>Resp. Authority Name:</label>
                <input
                  type="text"
                  [(ngModel)]="statement.respAuthority_name"
                  placeholder="Nombre de la autoridad"
                />
              </div>
              <div class="form-group">
                <label>Resp. Authority Country Code:</label>
                <input
                  type="text"
                  [(ngModel)]="statement.respAuthority_countryCode"
                  placeholder="Código de país"
                />
              </div>
              <div class="form-group">
                <label>Resp. Authority Post Code:</label>
                <input
                  type="text"
                  [(ngModel)]="statement.respAuthority_postCode"
                  placeholder="Código postal"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="empty-state" *ngIf="statements.length === 0">
    <div class="empty-content">
      <i class="material-icons">description</i>
      <h4>No hay statements agregados</h4>
      <p>
        Haz clic en "Agregar Statement" para comenzar a añadir declaraciones al
        certificado.
      </p>
    </div>
  </div>
</div>
